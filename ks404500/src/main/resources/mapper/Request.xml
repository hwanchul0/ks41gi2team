<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="ksmart41_teamtest.mapper.RequestMapper">
	<resultMap type="Request" id="requestResultMap">
		<result column="contractManageCode" 			property="contractManageCode"/>
		<result column="serviceName" 					property="serviceName"/>
		<result column="serviceAmount" 					property="serviceAmount"/>
		<result column="servicePeriod" 					property="servicePeriod"/>
		<result column="serviceTotalPrice" 				property="serviceTotalPrice"/>
		<result column="serviceRequestDate" 			property="serviceRequestDate"/>
		<result column="serviceRegistrationDate" 		property="serviceRegistrationDate"/>
		<result column="serviceEndDate" 				property="serviceEndDate"/>
		<result column="serviceRequestStatus" 			property="serviceRequestStatus"/>
		<result column="serviceApprovalDate" 			property="serviceApprovalDate"/>
	</resultMap>
		<select id="getRequestList" parameterType="String" resultMap="requestResultMap">
			SELECT
				 r.contractManageCode
				,m.serviceName
				,r.serviceAmount
				,r.servicePeriod
				,r.serviceTotalPrice
				,r.serviceRequestDate
				,r.serviceRegistrationDate
				,r.serviceEndDate
				,r.serviceRequestStatus
				,r.serviceApprovalDate
			FROM
				k2_sw_contractRequest AS r
				INNER JOIN 
				k2_sw_serviceManagement AS m
				ON 
				r.serviceCode = m.serviceCode
			ORDER BY serviceRequestDate ASC;
	</select>
		<select id="getMainBusinessCode" parameterType="String">
			SELECT 
				bR.clientId
			FROM 
				k2_sw_contractRequest AS cR
				INNER JOIN 
				k0_sw_mainBusinessCodeManagement AS mB
				ON 
				cR.mainBusinessCode = mB.mainBusinessCode
				INNER JOIN 
				k0_sw_businessRegistration AS bR
				ON 
				mB.businessRegistrationCode = bR.businessRegistrationCode;
	</select>
</mapper>